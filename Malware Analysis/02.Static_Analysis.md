## Linux
### Identifying The File Type
- check file type - `file [path_to_file]`
- check headers to find file type - `hexdump -C [path_to_file] | more`
### Malware Fingerprinting
- hash of a file - `md5sum [path_to_file]`
- hash of a file - `sha256sum [path_to_file]`
- online File Hash Lookup - example: virustotal
### Import Hashing (IMPHASH)
- hash calculated from the import functions of a Windows Portable Executable (PE) file can be checked on Virustotal or https://pypi.org/project/pefile/
```
import sys
import pefile
import peutils

pe_file = sys.argv[1]
pe = pefile.PE(pe_file)
imphash = pe.get_imphash()

print(imphash)
```
### Fuzzy Hashing (SSDEEP)
- `ssdeep [path_to_file]` or virustotal - highly effective in identifying files that have undergone minor modifications
- initiate matching mode in SSDEEP (while we are on the directory where the malware samples are stored) - `ssdeep -pb *`
### Section Hashing (Hashing PE Sections)
- identify sections of a Portable Executable (PE) file that have been modified
```
import sys
import pefile
pe_file = sys.argv[1]
pe = pefile.PE(pe_file)
for section in pe.sections:
    print (section.Name, "MD5 hash:", section.get_hash_md5())
    print (section.Name, "SHA256 hash:", section.get_hash_sha256())
```
### String Analysis
- `strings -n  [path_to_file]`
- `floss [path_to_file]`
- Unpacking UPX-packed Malware (when you see 'UPX' in strings) - `upx -d -o [output_filename] [input_filename]`

## Windows
### Identifying The File Type
- CFF Explorer - the presence of the ASCII string MZ (in hexadecimal: 4D 5A) at the start of a file (known as the "magic number") denotes an executable file
### Malware Fingerprinting
- powershell command - `Get-FileHash -Algorithm MD5 [path_to_file]`
- powershell command - `Get-FileHash -Algorithm SHA256 [path_to_file]`
- online File Hash Lookup - example: virustotal
### Import Hashing (IMPHASH)
- We can find the IMPHASH in the Details tab of the VirusTotal results.
- https://pypi.org/project/pefile/
- imphash.py the same as in linux section - `python imphash_calc.py [path_to_file]`
### Fuzzy Hashing (SSDEEP)
- virustotal Details tab
- need to download this program first -  `ssdeep.exe [path_to_file]`
### Section Hashing (Hashing PE Sections)
- need to download this program first - pestudio
- the same python code as in linux section
### String Analysis
